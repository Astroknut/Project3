(function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.AuthJs=t():e.AuthJs=t()})(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var n={};return t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,r){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:r})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p=".",t(t.s=10)}([function(e,t,n){"use strict";n.d(t,"b",function(){return r});var r="auth_token";t.a={setToken:function(e){this._token=e,localStorage.setItem(r,JSON.stringify(e))},getToken:function(){if(!this._token){var e=localStorage.getItem(r);this._token=e?JSON.parse(e):""}return this._token},removeToken:function(){delete this._token,localStorage.removeItem(r)}}},function(e,t,n){"use strict";var r=String.prototype.replace,o=/%20/g;e.exports={default:"RFC3986",formatters:{RFC1738:function(e){return r.call(e,o,"+")},RFC3986:function(e){return e}},RFC1738:"RFC1738",RFC3986:"RFC3986"}},function(e,t,n){"use strict";var r=Object.prototype.hasOwnProperty,o=function(){for(var e=[],t=0;t<256;++t)e.push("%"+((t<16?"0":"")+t.toString(16)).toUpperCase());return e}();t.arrayToObject=function(e,t){for(var n=t&&t.plainObjects?Object.create(null):{},r=0;r<e.length;++r)void 0!==e[r]&&(n[r]=e[r]);return n},t.merge=function(e,n,o){if(!n)return e;if("object"!=typeof n){if(Array.isArray(e))e.push(n);else{if("object"!=typeof e)return[e,n];(o.plainObjects||o.allowPrototypes||!r.call(Object.prototype,n))&&(e[n]=!0)}return e}if("object"!=typeof e)return[e].concat(n);var i=e;return Array.isArray(e)&&!Array.isArray(n)&&(i=t.arrayToObject(e,o)),Array.isArray(e)&&Array.isArray(n)?(n.forEach(function(n,i){r.call(e,i)?e[i]&&"object"==typeof e[i]?e[i]=t.merge(e[i],n,o):e.push(n):e[i]=n}),e):Object.keys(n).reduce(function(e,r){var i=n[r];return Object.prototype.hasOwnProperty.call(e,r)?e[r]=t.merge(e[r],i,o):e[r]=i,e},i)},t.decode=function(e){try{return decodeURIComponent(e.replace(/\+/g," "))}catch(t){return e}},t.encode=function(e){if(0===e.length)return e;for(var t="string"==typeof e?e:String(e),n="",r=0;r<t.length;++r){var i=t.charCodeAt(r);45===i||46===i||95===i||126===i||i>=48&&i<=57||i>=65&&i<=90||i>=97&&i<=122?n+=t.charAt(r):i<128?n+=o[i]:i<2048?n+=o[192|i>>6]+o[128|63&i]:i<55296||i>=57344?n+=o[224|i>>12]+o[128|i>>6&63]+o[128|63&i]:(r+=1,i=65536+((1023&i)<<10|1023&t.charCodeAt(r)),n+=o[240|i>>18]+o[128|i>>12&63]+o[128|i>>6&63]+o[128|63&i])}return n},t.compact=function(e,n){if("object"!=typeof e||null===e)return e;var r=n||[],o=r.indexOf(e);if(-1!==o)return r[o];if(r.push(e),Array.isArray(e)){for(var i=[],a=0;a<e.length;++a)e[a]&&"object"==typeof e[a]?i.push(t.compact(e[a],r)):void 0!==e[a]&&i.push(e[a]);return i}return Object.keys(e).forEach(function(n){e[n]=t.compact(e[n],r)}),e},t.isRegExp=function(e){return"[object RegExp]"===Object.prototype.toString.call(e)},t.isBuffer=function(e){return null!==e&&void 0!==e&&!!(e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer(e))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o=n(0),i=n(5);n.d(t,"AuthManager",function(){return r.a}),n.d(t,"TokenManager",function(){return o.a}),n.d(t,"CookieManager",function(){return i.a}),t.default=function(e){var t=e.tokenManager,n=e.baseURL,o=void 0===n?"":n,i=e.appModule,a=void 0===i?"":i;return new r.a({tokenManager:t,baseURL:o,appModule:a})}},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=n(7),i=n.n(o),a=n(6),c=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),s=function(){function e(t){var n=t.tokenManager,o=t.baseURL,i=void 0===o?"":o,a=t.appModule,c=void 0===a?"":a,s=t.authPath,u=void 0===s?"auth":s;r(this,e),this.baseURL=i,this.tokenManager=n,this.appModule=c,this.authPath=u}return c(e,[{key:"open",value:function(e,t){var n=this;t._close=1;var r=this.baseURL+"/"+this.authPath+"/"+e+"?"+i.a.stringify(t);return window.cordova&&window.cordova.InAppBrowser?this.inApp=window.cordova.InAppBrowser.open(r,"_blank","location=no,zoom=no"):this.iframe=a.a.iframeCreate(r),new Promise(function(e,t){var r=new URL(n.baseURL);n._resolve=function(t){r.origin===t.origin&&e(JSON.parse(t.message||t.data))},window.addEventListener("message",n._resolve,!1)})}},{key:"close",value:function(){this.iframe&&this.iframe.remove(),this.inApp&&this.inApp.close(),window.removeEventListener("message",this._resolve,!1)}},{key:"signIn",value:function(){return this.openAction("sign_in",{return_to:"postMessage"})}},{key:"updatePassowrd",value:function(){return this.openAction("update_password",this.tokenAsQS())}},{key:"account",value:function(){return this.openAction("account",this.tokenAsQS())}},{key:"image",value:function(){return this.openAction("image",this.tokenAsQS())}},{key:"address",value:function(){return this.openAction("address",this.tokenAsQS())}},{key:"modules",value:function(){return this.openAction("modules",this.tokenAsQS())}},{key:"openAction",value:function(e,t){var n=this;return this.open(e+"/"+this.appModule,t).then(function(e){return e.token&&e.token.uid&&n.tokenManager.setToken(e.token),n.close(),e})}},{key:"getToken",value:function(){return this._token||(this._token=this.tokenManager.getToken()),this._token}},{key:"current",value:function(){return a.a.$http(this.baseURL+"/usuarios/current",{headers:this.getToken()})}},{key:"signOut",value:function(){var e=this;return a.a.$http(this.baseURL+"/usuarios",{headers:this.getToken(),method:"delete"}).then(function(t){return e._token=null,e.tokenManager.removeToken(),t})}},{key:"tokenAsQS",value:function(){return{_t:a.a.tokenEncode(this.getToken())}}}]),e}();t.a=s},function(e,t,n){"use strict";var r=n(0);t.a={setToken:function(e){document.cookie=r.b+"="+JSON.stringify(e)},getToken:function(){var e=new RegExp("(?:(?:^|.*;s*)"+r.b+"s*=s*([^;]*).*$)|^.*$"),t=document.cookie.replace(e,"$1");return t?JSON.parse(t):""},removeToken:function(){document.cookie=r.b+"="}}},function(e,t,n){"use strict";t.a={iframeCreate:function(e){var t=document.createElement("iframe");return t.src=e,t.style.width=window.innerWidth+"px",t.style.height=window.innerHeight+"px",t.style.position="fixed",t.style.top=0,t.style.left=0,t.style.border="none",t.style.margin=0,t.style.zIndex=99999,t.style.background='#fff url("data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiIHN0YW5kYWxvbmU9Im5vIj8+PHN2ZyB4bWxuczpzdmc9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB2ZXJzaW9uPSIxLjAiIHdpZHRoPSI3MnB4IiBoZWlnaHQ9IjcycHgiIHZpZXdCb3g9IjAgMCAxMjggMTI4IiB4bWw6c3BhY2U9InByZXNlcnZlIj48Zz48cGF0aCBmaWxsPSIjOTk5OTk5IiBkPSJNMTA5LjI1IDU1LjVoLTM2bDEyLTEyYTI5LjU0IDI5LjU0IDAgMCAwLTQ5LjUzIDEySDE4Ljc1QTQ2LjA0IDQ2LjA0IDAgMCAxIDk2LjkgMzEuODRsMTIuMzUtMTIuMzR2MzZ6bS05MC41IDE3aDM2bC0xMiAxMmEyOS41NCAyOS41NCAwIDAgMCA0OS41My0xMmgxNi45N0E0Ni4wNCA0Ni4wNCAwIDAgMSAzMS4xIDk2LjE2TDE4Ljc0IDEwOC41di0zNnoiLz48YW5pbWF0ZVRyYW5zZm9ybSBhdHRyaWJ1dGVOYW1lPSJ0cmFuc2Zvcm0iIHR5cGU9InJvdGF0ZSIgZnJvbT0iMCA2NCA2NCIgdG89IjM2MCA2NCA2NCIgZHVyPSIxMDQwbXMiIHJlcGVhdENvdW50PSJpbmRlZmluaXRlIj48L2FuaW1hdGVUcmFuc2Zvcm0+PC9nPjwvc3ZnPg==") center center no-repeat',document.body.appendChild(t),t},$http:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise(function(n,r){var o=new XMLHttpRequest;if(o.timeout=1e4,o.onerror=function(e){return r(e)},o.onload=function(e){return o.status>=200&&o.status<400?n(o.response):r(e)},o.responseType="json",o.open(t.method||"get",e),t.headers)for(var i in t.headers)o.setRequestHeader(i,t.headers[i]);o.send()})},tokenEncode:function(e){return btoa(JSON.stringify(e))},tokenDecode:function(e){return atob(JSON.parse(e))}}},function(e,t,n){"use strict";var r=n(9),o=n(8),i=n(1);e.exports={formats:i,parse:o,stringify:r}},function(e,t,n){"use strict";var r=n(2),o=Object.prototype.hasOwnProperty,i={allowDots:!1,allowPrototypes:!1,arrayLimit:20,decoder:r.decode,delimiter:"&",depth:5,parameterLimit:1e3,plainObjects:!1,strictNullHandling:!1},a=function(e,t){for(var n={},r=e.split(t.delimiter,t.parameterLimit===1/0?void 0:t.parameterLimit),i=0;i<r.length;++i){var a,c,s=r[i],u=-1===s.indexOf("]=")?s.indexOf("="):s.indexOf("]=")+1;-1===u?(a=t.decoder(s),c=t.strictNullHandling?null:""):(a=t.decoder(s.slice(0,u)),c=t.decoder(s.slice(u+1))),o.call(n,a)?n[a]=[].concat(n[a]).concat(c):n[a]=c}return n},c=function(e,t,n){if(!e.length)return t;var r,o=e.shift();if("[]"===o)r=[],r=r.concat(c(e,t,n));else{r=n.plainObjects?Object.create(null):{};var i="["===o.charAt(0)&&"]"===o.charAt(o.length-1)?o.slice(1,-1):o,a=parseInt(i,10);!isNaN(a)&&o!==i&&String(a)===i&&a>=0&&n.parseArrays&&a<=n.arrayLimit?(r=[],r[a]=c(e,t,n)):r[i]=c(e,t,n)}return r},s=function(e,t,n){if(e){var r=n.allowDots?e.replace(/\.([^.[]+)/g,"[$1]"):e,i=/(\[[^[\]]*])/,a=/(\[[^[\]]*])/g,s=i.exec(r),u=s?r.slice(0,s.index):r,l=[];if(u){if(!n.plainObjects&&o.call(Object.prototype,u)&&!n.allowPrototypes)return;l.push(u)}for(var f=0;null!==(s=a.exec(r))&&f<n.depth;){if(f+=1,!n.plainObjects&&o.call(Object.prototype,s[1].slice(1,-1))&&!n.allowPrototypes)return;l.push(s[1])}return s&&l.push("["+r.slice(s.index)+"]"),c(l,t,n)}};e.exports=function(e,t){var n=t||{};if(null!==n.decoder&&void 0!==n.decoder&&"function"!=typeof n.decoder)throw new TypeError("Decoder has to be a function.");if(n.delimiter="string"==typeof n.delimiter||r.isRegExp(n.delimiter)?n.delimiter:i.delimiter,n.depth="number"==typeof n.depth?n.depth:i.depth,n.arrayLimit="number"==typeof n.arrayLimit?n.arrayLimit:i.arrayLimit,n.parseArrays=!1!==n.parseArrays,n.decoder="function"==typeof n.decoder?n.decoder:i.decoder,n.allowDots="boolean"==typeof n.allowDots?n.allowDots:i.allowDots,n.plainObjects="boolean"==typeof n.plainObjects?n.plainObjects:i.plainObjects,n.allowPrototypes="boolean"==typeof n.allowPrototypes?n.allowPrototypes:i.allowPrototypes,n.parameterLimit="number"==typeof n.parameterLimit?n.parameterLimit:i.parameterLimit,n.strictNullHandling="boolean"==typeof n.strictNullHandling?n.strictNullHandling:i.strictNullHandling,""===e||null===e||void 0===e)return n.plainObjects?Object.create(null):{};for(var o="string"==typeof e?a(e,n):e,c=n.plainObjects?Object.create(null):{},u=Object.keys(o),l=0;l<u.length;++l){var f=u[l],p=s(f,o[f],n);c=r.merge(c,p,n)}return r.compact(c)}},function(e,t,n){"use strict";var r=n(2),o=n(1),i={brackets:function(e){return e+"[]"},indices:function(e,t){return e+"["+t+"]"},repeat:function(e){return e}},a=Date.prototype.toISOString,c={delimiter:"&",encode:!0,encoder:r.encode,encodeValuesOnly:!1,serializeDate:function(e){return a.call(e)},skipNulls:!1,strictNullHandling:!1},s=function e(t,n,o,i,a,c,s,u,l,f,p,d){var y=t;if("function"==typeof s)y=s(n,y);else if(y instanceof Date)y=f(y);else if(null===y){if(i)return c&&!d?c(n):n;y=""}if("string"==typeof y||"number"==typeof y||"boolean"==typeof y||r.isBuffer(y)){if(c){return[p(d?n:c(n))+"="+p(c(y))]}return[p(n)+"="+p(String(y))]}var h=[];if(void 0===y)return h;var v;if(Array.isArray(s))v=s;else{var m=Object.keys(y);v=u?m.sort(u):m}for(var g=0;g<v.length;++g){var b=v[g];a&&null===y[b]||(h=Array.isArray(y)?h.concat(e(y[b],o(n,b),o,i,a,c,s,u,l,f,p,d)):h.concat(e(y[b],n+(l?"."+b:"["+b+"]"),o,i,a,c,s,u,l,f,p,d)))}return h};e.exports=function(e,t){var n=e,r=t||{};if(null!==r.encoder&&void 0!==r.encoder&&"function"!=typeof r.encoder)throw new TypeError("Encoder has to be a function.");var a=void 0===r.delimiter?c.delimiter:r.delimiter,u="boolean"==typeof r.strictNullHandling?r.strictNullHandling:c.strictNullHandling,l="boolean"==typeof r.skipNulls?r.skipNulls:c.skipNulls,f="boolean"==typeof r.encode?r.encode:c.encode,p="function"==typeof r.encoder?r.encoder:c.encoder,d="function"==typeof r.sort?r.sort:null,y=void 0!==r.allowDots&&r.allowDots,h="function"==typeof r.serializeDate?r.serializeDate:c.serializeDate,v="boolean"==typeof r.encodeValuesOnly?r.encodeValuesOnly:c.encodeValuesOnly;if(void 0===r.format)r.format=o.default;else if(!Object.prototype.hasOwnProperty.call(o.formatters,r.format))throw new TypeError("Unknown format option provided.");var m,g,b=o.formatters[r.format];"function"==typeof r.filter?(g=r.filter,n=g("",n)):Array.isArray(r.filter)&&(g=r.filter,m=g);var k=[];if("object"!=typeof n||null===n)return"";var A;A=r.arrayFormat in i?r.arrayFormat:"indices"in r?r.indices?"indices":"repeat":"indices";var j=i[A];m||(m=Object.keys(n)),d&&m.sort(d);for(var w=0;w<m.length;++w){var O=m[w];l&&null===n[O]||(k=k.concat(s(n[O],O,j,u,l,f?p:null,g,d,y,h,b,v)))}return k.join(a)}},function(e,t,n){e.exports=n(3)}])});